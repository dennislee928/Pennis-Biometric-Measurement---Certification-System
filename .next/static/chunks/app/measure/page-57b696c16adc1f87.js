(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[915],{75410:function(){},48628:function(){},31601:function(){},67792:function(){},34977:function(){},75042:function(){},82788:function(e,t,a){Promise.resolve().then(a.bind(a,74142))},74142:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return k}});var r=a(57437),n=a(2265),i=a(50965),s=a(96586);let l=!1;async function o(){if(!l)try{await s.CQI("wasm"),await s.Cd_(),l=!0}catch(e){try{await s.CQI("cpu"),await s.Cd_(),l=!0}catch(e){throw console.warn("TF.js backend init fallback failed",e),e}}}var c=a(59941),d=a(79025),u=a(97501),m=a(96264),p=a(48652),h=a(6881),f=a(35648),g=a(80233),x=a(77515),v=a(74109);function b(e){let{onCapture:t,onMeasurementReady:a,referenceFrameWidthRatio:i=.25,passportAspect:s,enableBlur:l=!0,minLuminance:o=40,minBlurScore:c=2}=e,{t:d}=(0,f.Q)(),u=(0,n.useRef)(null),m=(0,n.useRef)(null),p=(0,n.useRef)(null),[h,b]=(0,n.useState)("idle"),[y,w]=(0,n.useState)(null),[N,j]=(0,n.useState)({light:!0,sharp:!0}),C=(0,n.useRef)(0),I=(0,n.useCallback)(()=>{p.current&&(p.current.getTracks().forEach(e=>e.stop()),p.current=null)},[]),k=(0,n.useCallback)(async()=>{w(null),b("idle");try{let e=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:1280,height:720},audio:!1});p.current=e,u.current&&(u.current.srcObject=e,await u.current.play()),b("live")}catch(e){w(e instanceof Error?e.message:d("camera.error")),b("error")}},[]);(0,n.useEffect)(()=>(k(),()=>{I()}),[k,I]);let P=(0,n.useCallback)(()=>{let e=u.current,t=m.current;if(!e||!t||e.readyState<2)return;let a=t.getContext("2d");if(!a)return;t.width=e.videoWidth,t.height=e.videoHeight,a.drawImage(e,0,0);let r=a.getImageData(0,0,t.width,t.height);j({light:function(e){let t=e.data,a=0,r=0;for(let e=0;e<t.length;e+=4)a+=.299*t[e]+.587*t[e+1]+.114*t[e+2],r++;return r>0?a/r:0}(r)>=o,sharp:function(e){let{data:t,width:a,height:r}=e,n=0,i=0;for(let e=1;e<r-1;e+=4)for(let r=1;r<a-1;r+=4){let s=(e*a+r)*4,l=(t[s]+t[s+1]+t[s+2])/3;n+=Math.abs(-((t[((e-1)*a+r)*4]+t[((e-1)*a+r)*4+1]+t[((e-1)*a+r)*4+2])/3)+2*l-(t[((e+1)*a+r)*4]+t[((e+1)*a+r)*4+1]+t[((e+1)*a+r)*4+2])/3),i++}return i>0?n/i:0}(r)>=c})},[o,c]);(0,n.useEffect)(()=>{if("live"!==h)return;let e=setInterval(()=>{Date.now()-C.current<500||(C.current=Date.now(),P())},800);return()=>clearInterval(e)},[h,P]);let S=(0,n.useCallback)(()=>{let e=u.current,a=m.current;if(!e||!a||e.readyState<2)return;let r=a.getContext("2d");if(!r)return;a.width=e.videoWidth,a.height=e.videoHeight,r.drawImage(e,0,0);let n=r.getImageData(0,0,a.width,a.height);null==t||t(n,!0),b("captured")},[t]),E=(0,n.useCallback)(()=>{b("live")},[]),D=640*i,R=72+D*(null!=s?s:85.6/53.98);return(0,r.jsxs)("div",{className:"flex flex-col items-center gap-4",children:[(0,r.jsxs)("div",{className:"relative overflow-hidden rounded-xl bg-black",style:{width:640,height:480},children:[(0,r.jsx)("video",{ref:u,autoPlay:!0,playsInline:!0,muted:!0,className:"h-full w-full object-cover ".concat(l?"sensitive-blur":""),style:{transform:"scaleX(-1)"}}),(0,r.jsx)("canvas",{ref:m,className:"hidden"}),"live"===h&&(0,r.jsxs)("div",{className:"camera-overlay",children:[(0,r.jsx)("div",{className:"camera-overlay__frame",style:{left:(640-D)/2,top:72,width:D,height:R-72}}),(0,r.jsx)("div",{className:"camera-overlay__hint",style:{left:0,right:0,top:44},children:d("reference.passportHint")}),(0,r.jsx)("div",{className:"camera-overlay__hint",style:{left:0,right:0,bottom:24},children:d("reference.captureHint")})]})]}),"live"===h&&(0,r.jsxs)("div",{className:"flex items-center gap-4 text-sm",children:[(0,r.jsx)("span",{className:N.light?"text-green-600":"text-amber-600",children:N.light?d("camera.bright"):d("camera.dark")}),(0,r.jsx)("span",{className:N.sharp?"text-green-600":"text-amber-600",children:N.sharp?d("camera.sharp"):d("camera.blur")})]}),"live"===h&&(0,r.jsxs)("button",{type:"button",onClick:S,disabled:!N.light||!N.sharp,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-600 px-6 py-3 text-white transition hover:bg-emerald-700 disabled:opacity-50",children:[(0,r.jsx)(g.Z,{className:"h-5 w-5"}),d("camera.capture")]}),"captured"===h&&(0,r.jsx)("button",{type:"button",onClick:E,className:"rounded-lg border border-slate-300 bg-white px-4 py-2 text-slate-700 hover:bg-slate-50",children:d("camera.retake")}),"error"===h&&(0,r.jsxs)("div",{className:"flex items-center gap-2 rounded-lg bg-red-50 p-4 text-red-800",children:[(0,r.jsx)(x.Z,{className:"h-5 w-5 shrink-0"}),(0,r.jsx)("span",{children:y}),(0,r.jsx)("button",{type:"button",onClick:k,className:"ml-2 rounded bg-red-100 px-3 py-1 text-sm hover:bg-red-200",children:d("camera.retry")})]}),"idle"===h&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-slate-500",children:[(0,r.jsx)(v.Z,{className:"h-5 w-5 animate-spin"}),d("camera.starting")]})]})}let y="https://cdn.withpersona.com/dist/persona-v4.8.0.js";var w=a(20500),N=a(15862),j=a(37164),C=a(87138);let I=125/88;function k(){var e,t;let{t:a,locale:s}=(0,f.Q)(),[l,g]=(0,n.useState)("camera"),[x,k]=(0,n.useState)(null),[P,S]=(0,n.useState)(null),[E,D]=(0,n.useState)(null),[R,A]=(0,n.useState)(""),[L,F]=(0,n.useState)(!1),[q,T]=(0,n.useState)(!1);(0,n.useEffect)(()=>{o().catch(()=>{})},[]);let _=(0,n.useCallback)((e,t)=>{let a=function(e,t){var a;let{width:r,height:n}=e,i=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8.56,[a,r,n,i]=e,s=(Math.hypot(r.x-a.x,r.y-a.y)+Math.hypot(n.x-i.x,n.y-i.y))/2;return s<=0?0:s/t}(function(e,t){let a=.25*e,r=(e-a)/2,n=.15*t,i=a*I;return[{x:r,y:n},{x:r+a,y:n},{x:r+a,y:n+i},{x:r,y:n+i}]}(r,n),8.8);return i<=0?null:(a=.35*n,{lengthCm:i<=0?0:a/i,ppm:i,timestamp:Date.now(),liveCaptured:t})}(e,t);a&&(k(a),g("measure"))},[]),{ready:O,error:H,open:B}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"sandbox",a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},[r,i]=(0,n.useState)(!1),[s,l]=(0,n.useState)(null),o=(0,n.useRef)(null),{onComplete:c,onCancel:d,onError:u}=a,m=(0,n.useCallback)(()=>{o.current&&o.current.open()},[]);return(0,n.useEffect)(()=>{if(!e)return;if(document.querySelector('script[src="'.concat(y,'"]'))){var a;if(null===(a=window.Persona)||void 0===a?void 0:a.Client)try{let a=new window.Persona.Client({templateId:e,environment:t,onReady:()=>i(!0),onComplete:e=>null==c?void 0:c(e),onCancel:e=>null==d?void 0:d(e),onError:e=>{l(String(e)),null==u||u(e)}});o.current=a,i(!0)}catch(e){l(e instanceof Error?e.message:"Persona 初始化失敗")}return}let r=document.createElement("script");return r.src=y,r.async=!0,r.onload=()=>{var a;if(!(null===(a=window.Persona)||void 0===a?void 0:a.Client)){l("Persona SDK 載入失敗");return}try{let a=new window.Persona.Client({templateId:e,environment:t,onReady:()=>{i(!0),l(null)},onComplete:e=>null==c?void 0:c(e),onCancel:e=>null==d?void 0:d(e),onError:e=>{l(String(e)),null==u||u(e)}});o.current=a}catch(e){l(e instanceof Error?e.message:"Persona 初始化失敗"),null==u||u(e)}},r.onerror=()=>{l("Persona 腳本載入失敗")},document.body.appendChild(r),()=>{o.current=null,i(!1)}},[e,t,c,d,u]),{ready:r,error:s,open:m}}("itmpl_xxxxxxxx","sandbox",{onComplete:e=>{let{inquiryId:t}=e;D(t),g("cert")},onError:()=>{}}),{session:M,accessToken:U}=(0,p.a)(),[z,J]=(0,n.useState)(null),Z=(0,n.useCallback)(()=>{g("verify"),B()},[B]),V=(0,n.useCallback)(async()=>{if(E&&x&&U){J(null);try{let e=await (0,m.$F)(U,E,x);S(e),(0,c.cP)(e),(0,i.Z)({particleCount:80,spread:60})}catch(e){J(e instanceof Error?e.message:a("error.issueFailed"))}}},[E,x,U,a]),W=x?{holderName:R,lengthCm:x.lengthCm,issuedAt:null!==(t=null==P?void 0:P.issuedAt)&&void 0!==t?t:new Date().toISOString(),inquiryId:null!=E?E:void 0}:null,G=(0,n.useCallback)(()=>{W&&(!function(e,t){let a=function(e,t){var a,r,n,i,s,l;let o=document.createElement("canvas");o.width=600,o.height=400;let c=o.getContext("2d"),u=d.s[t];c.fillStyle="#ffffff",c.fillRect(0,0,600,400),c.strokeStyle="#1e293b",c.lineWidth=2,c.strokeRect(8,8,584,384),c.fillStyle="#0f172a",c.font="bold 22px system-ui, sans-serif",c.textAlign="center",c.fillText(null!==(a=u["cert.title"])&&void 0!==a?a:"Biometric Measurement Certificate",300,68),c.font="16px system-ui, sans-serif",c.textAlign="left";let m=110;return c.fillText("".concat(null!==(r=u["cert.holder"])&&void 0!==r?r:"Holder",": ").concat(e.holderName||"—"),40,m),m+=28,c.fillText("".concat(null!==(n=u["cert.length"])&&void 0!==n?n:"Length",": ").concat(e.lengthCm.toFixed(2)," cm"),40,m),m+=28,c.fillText("".concat(null!==(i=u["cert.issuedAt"])&&void 0!==i?i:"Issued at",": ").concat(e.issuedAt),40,m),e.inquiryId&&(m+=28,c.fillText("".concat(null!==(s=u["cert.inquiryId"])&&void 0!==s?s:"Inquiry ID",": ").concat(e.inquiryId),40,m)),m=332,c.font="11px system-ui, sans-serif",c.fillStyle="#64748b",c.textAlign="center",c.fillText(null!==(l=u["cert.footer"])&&void 0!==l?l:"On-device measurement. Identity verified via Persona.",300,m),o.toDataURL("image/png")}(e,t),r=document.createElement("a");r.href=a,r.download="certificate-".concat(Date.now(),".png"),r.click()}(W,s),F(!0))},[W,s]),Q=(0,n.useCallback)(()=>{W&&(!function(e,t){var a,r,n,i,s,l;let o=new u.kH,c=d.s[t],m=25;o.setFontSize(18),o.setFont("helvetica","bold"),o.text(null!==(a=c["cert.title"])&&void 0!==a?a:"Biometric Measurement Certificate",105,m,{align:"center"}),m+=18,o.setFontSize(12),o.setFont("helvetica","normal"),o.text("".concat(null!==(r=c["cert.holder"])&&void 0!==r?r:"Holder",": ").concat(e.holderName||"—"),20,m),m+=10,o.text("".concat(null!==(n=c["cert.length"])&&void 0!==n?n:"Length",": ").concat(e.lengthCm.toFixed(2)," cm"),20,m),m+=10,o.text("".concat(null!==(i=c["cert.issuedAt"])&&void 0!==i?i:"Issued at",": ").concat(e.issuedAt),20,m),m+=10,e.inquiryId&&(o.text("".concat(null!==(s=c["cert.inquiryId"])&&void 0!==s?s:"Inquiry ID",": ").concat(e.inquiryId),20,m),m+=10),m=277,o.setFontSize(9),o.setTextColor(100,116,139),o.text(null!==(l=c["cert.footer"])&&void 0!==l?l:"On-device measurement. Identity verified via Persona.",105,m,{align:"center"}),o.save("certificate-".concat(Date.now(),".pdf"))}(W,s),T(!0))},[W,s]);return(0,r.jsxs)("main",{className:"min-h-screen bg-slate-50 px-4 py-8",children:[(0,r.jsxs)("nav",{className:"mx-auto mb-6 flex max-w-2xl items-center justify-between text-sm",children:[(0,r.jsx)(C.default,{href:"/",className:"text-slate-600 hover:text-slate-900",children:a("nav.home")}),(0,r.jsxs)("div",{className:"flex items-center gap-4",children:[(0,r.jsx)(C.default,{href:"/verify",className:"text-slate-600 hover:text-slate-900",children:a("nav.verify")}),(0,r.jsx)(C.default,{href:"/certificates",className:"text-slate-600 hover:text-slate-900",children:a("nav.myCerts")}),M?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("span",{className:"text-slate-500",children:null===(e=M.user)||void 0===e?void 0:e.email}),(0,r.jsx)("button",{type:"button",onClick:()=>(0,h.S)().auth.signOut(),className:"text-slate-600 hover:text-slate-900",children:a("nav.logout")})]}):(0,r.jsx)(C.default,{href:"/login",className:"rounded bg-slate-800 px-3 py-1.5 text-white hover:bg-slate-700",children:a("nav.login")})]})]}),(0,r.jsxs)("div",{className:"mx-auto max-w-2xl space-y-8",children:[(0,r.jsxs)("header",{className:"text-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:a("welcome.title")}),(0,r.jsx)("p",{className:"mt-2 text-sm text-slate-600",children:a("welcome.subtitle")})]}),"camera"===l&&(0,r.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:a("step1.title")}),(0,r.jsx)("p",{className:"mb-4 text-sm text-slate-600",children:a("step1.hint")}),(0,r.jsx)(b,{onCapture:_,referenceFrameWidthRatio:.25,passportAspect:I,enableBlur:!0})]}),"measure"===l&&x&&(0,r.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:a("step2.title")}),(0,r.jsxs)("div",{className:"mb-4 rounded-lg bg-slate-100 p-4",children:[(0,r.jsx)("p",{className:"text-sm text-slate-600",children:a("step2.length")}),(0,r.jsxs)("p",{className:"text-2xl font-bold text-slate-900",children:[x.lengthCm.toFixed(2)," cm"]}),(0,r.jsxs)("p",{className:"mt-2 text-xs text-slate-500",children:[a("step2.live"),": ",x.liveCaptured?a("step2.yes"):a("step2.no")," \xb7 PPM: ",x.ppm.toFixed(1)]})]}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{type:"button",onClick:()=>g("camera"),className:"rounded-lg border border-slate-300 px-4 py-2 text-sm text-slate-700 hover:bg-slate-50",children:a("step2.retake")}),(0,r.jsx)("button",{type:"button",onClick:Z,disabled:!O,className:"inline-flex items-center gap-2 rounded-lg bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700 disabled:opacity-50",children:O?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{className:"h-4 w-4"}),a("step2.verify")]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(v.Z,{className:"h-4 w-4 animate-spin"}),a("step2.loading")]})})]}),H&&(0,r.jsx)("p",{className:"mt-2 text-sm text-amber-600",children:H})]}),"verify"===l&&(0,r.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:a("step3.title")}),(0,r.jsx)("p",{className:"mb-4 text-sm text-slate-600",children:a("step3.hint")}),(0,r.jsx)("button",{type:"button",onClick:B,className:"rounded-lg bg-indigo-600 px-4 py-2 text-sm text-white hover:bg-indigo-700",children:a("step3.openAgain")})]}),"cert"===l&&x&&(0,r.jsxs)("section",{className:"rounded-2xl border border-slate-200 bg-white p-6 shadow-sm",children:[(0,r.jsx)("h2",{className:"mb-4 text-lg font-semibold",children:a("step4.title")}),E&&(0,r.jsxs)("p",{className:"mb-4 text-sm text-slate-600",children:[a("step4.inquiryId"),": ",(0,r.jsx)("code",{className:"rounded bg-slate-100 px-1",children:E})]}),U?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"mb-4 rounded-lg bg-emerald-50 p-4",children:(0,r.jsxs)("p",{className:"flex items-center gap-2 text-emerald-800",children:[(0,r.jsx)(N.Z,{className:"h-5 w-5"}),a("step4.certReady")]})}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"holder-name",className:"mb-1 block text-sm font-medium text-slate-700",children:a("step4.holderName")}),(0,r.jsx)("input",{id:"holder-name",type:"text",value:R,onChange:e=>A(e.target.value),placeholder:a("step4.holderNamePlaceholder"),className:"w-full rounded border border-slate-300 px-3 py-2 text-slate-900 placeholder:text-slate-400"})]}),(0,r.jsxs)("div",{className:"mb-4 flex flex-wrap gap-3",children:[(0,r.jsxs)("button",{type:"button",onClick:G,disabled:L,className:"inline-flex items-center gap-2 rounded-lg bg-slate-700 px-4 py-2 text-white hover:bg-slate-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),L?a("step4.downloaded"):a("step4.downloadPng")]}),(0,r.jsxs)("button",{type:"button",onClick:Q,disabled:q,className:"inline-flex items-center gap-2 rounded-lg bg-slate-700 px-4 py-2 text-white hover:bg-slate-800 disabled:opacity-60 disabled:cursor-not-allowed",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),q?a("step4.downloaded"):a("step4.downloadPdf")]})]}),z&&(0,r.jsx)("p",{className:"mb-2 text-sm text-red-600",children:z}),(0,r.jsxs)("button",{type:"button",onClick:V,className:"inline-flex items-center gap-2 rounded-lg bg-emerald-600 px-4 py-2 text-white hover:bg-emerald-700",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),a("step4.downloadJson")]})]}):(0,r.jsxs)("div",{className:"rounded-lg bg-amber-50 p-4 text-amber-800",children:[(0,r.jsx)("p",{className:"mb-2",children:a("step4.loginRequired")}),(0,r.jsx)(C.default,{href:"/login",className:"text-sm font-medium underline",children:a("step4.goLogin")})]})]})]})]})}},96264:function(e,t,a){"use strict";a.d(t,{$F:function(){return n},EN:function(){return i},mv:function(){return s},ys:function(){return l}});let r=a(20357).env.NEXT_PUBLIC_API_URL||"http://localhost:8080";async function n(e,t,a){let n=await fetch("".concat(r,"/api/certificates"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify({inquiryId:t,measurement:a})});if(!n.ok)throw Error((await n.json().catch(()=>({}))).error||n.statusText);return n.json()}async function i(e){let t=await fetch("".concat(r,"/api/certificates"),{headers:{Authorization:"Bearer ".concat(e)}});if(!t.ok)throw Error(t.statusText);return t.json()}async function s(e,t){let a=await fetch("".concat(r,"/api/certificates/").concat(t),{headers:{Authorization:"Bearer ".concat(e)}});if(!a.ok)throw Error(a.statusText);return a.json()}async function l(e){let t=await fetch("".concat(r,"/api/certificates/verify"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw Error(t.statusText);return t.json()}},59941:function(e,t,a){"use strict";function r(e){let t=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download="certification-".concat(e.inquiryId,"-").concat(Date.now(),".json"),r.click(),URL.revokeObjectURL(a)}a.d(t,{cP:function(){return r}})},35648:function(e,t,a){"use strict";a.d(t,{I18nProvider:function(){return o},Q:function(){return c}});var r=a(57437),n=a(2265),i=a(79025);let s="locale",l=(0,n.createContext)(null);function o(e){let{children:t}=e,[a,o]=(0,n.useState)("en"),[c,d]=(0,n.useState)(!1);(0,n.useEffect)(()=>{o(function(){if("undefined"==typeof document)return"en";let e=document.cookie.match(new RegExp("(?:^|; )".concat(s,"=([^;]*)"))),t=e?decodeURIComponent(e[1]):"";return"zh-TW"===t||"ja"===t||"es"===t||"en"===t?t:"en"}()),d(!0)},[]);let u=(0,n.useCallback)(e=>{o(e),document.cookie="".concat(s,"=").concat(encodeURIComponent(e),";path=/;max-age=31536000")},[]),m=(0,n.useCallback)(e=>{var t;let r=i.s[a];return null!==(t=null==r?void 0:r[e])&&void 0!==t?t:e},[a]);return(0,n.useEffect)(()=>{c&&"undefined"!=typeof document&&(document.documentElement.lang="zh-TW"===a?"zh-TW":"ja"===a?"ja":"es"===a?"es":"en")},[a,c]),(0,r.jsx)(l.Provider,{value:{locale:a,setLocale:u,t:m},children:t})}function c(){let e=(0,n.useContext)(l);if(!e)throw Error("useI18n must be used within I18nProvider");return e}},79025:function(e,t,a){"use strict";a.d(t,{s:function(){return r}});let r={en:{"welcome.title":"Biometric Measurement & Certification","welcome.subtitle":"On-device measurement. No images leave your device. Identity verification for a digital certificate.","welcome.start":"Start measurement","nav.verify":"Verify certificate","nav.myCerts":"My certificates","nav.login":"Log in","nav.logout":"Log out","nav.home":"Home","step1.title":"Step 1 Camera capture","step1.hint":"Align your passport (closed) with the green frame and ensure good lighting, then capture.","step2.title":"Step 2 Measurement result","step2.length":"Length (cm)","step2.live":"Live capture","step2.yes":"Yes","step2.no":"No","step2.retake":"Retake","step2.verify":"Verify identity","step2.loading":"Loading…","step3.title":"Step 3 Identity verification (Persona)","step3.hint":"Complete government ID and face scan in the popup. You will then proceed to the certificate step.","step3.openAgain":"Open verification again","step4.title":"Step 4 Digital certificate","step4.inquiryId":"Verification ID","step4.loginRequired":"Please log in to download the certificate.","step4.goLogin":"Go to login","step4.certReady":"Digital certificate (backend-signed) is ready.","step4.downloadJson":"Download certificate JSON","step4.downloadPng":"Download certificate PNG","step4.downloadPdf":"Download certificate PDF","step4.downloaded":"Downloaded","step4.holderName":"Holder name","step4.holderNamePlaceholder":"Enter your name","reference.passportHint":"Align passport (closed) with the green frame","reference.captureHint":"Then tap Capture","camera.bright":"Bright enough","camera.dark":"Low light","camera.sharp":"Sharp","camera.blur":"Blurred","camera.capture":"Capture","camera.retake":"Retake","camera.starting":"Starting camera…","camera.error":"Cannot access camera","camera.retry":"Retry","cert.title":"Biometric Measurement Certificate","cert.holder":"Holder","cert.length":"Length","cert.issuedAt":"Issued at","cert.inquiryId":"Inquiry ID","cert.footer":"On-device measurement. Identity verified via Persona.","error.issueFailed":"Certificate issue failed"},"zh-TW":{"welcome.title":"生物測量與認證系統","welcome.subtitle":"端上測量 \xb7 影像不離裝置 \xb7 身分驗證後取得數位證書","welcome.start":"開始測量","nav.verify":"驗證證書","nav.myCerts":"我的證書","nav.login":"登入","nav.logout":"登出","nav.home":"首頁","step1.title":"步驟 1 相機擷取","step1.hint":"請將護照（閉合）對齊綠色框，並確保光線充足、畫面清晰後擷取。","step2.title":"步驟 2 測量結果","step2.length":"長度（公分）","step2.live":"即時擷取","step2.yes":"是","step2.no":"否","step2.retake":"重新拍攝","step2.verify":"進行身分驗證","step2.loading":"載入驗證…","step3.title":"步驟 3 身分驗證 (Persona)","step3.hint":"請在彈窗中完成政府證件與人臉掃描。完成後將自動進入證書步驟。","step3.openAgain":"再次開啟驗證","step4.title":"步驟 4 數位證書","step4.inquiryId":"身分驗證 ID","step4.loginRequired":"請先登入後再下載證書。","step4.goLogin":"前往登入","step4.certReady":"可下載數位認證證書（後端簽名）","step4.downloadJson":"下載證書 JSON","step4.downloadPng":"下載證書 PNG","step4.downloadPdf":"下載證書 PDF","step4.downloaded":"已下載","step4.holderName":"持有人姓名","step4.holderNamePlaceholder":"請輸入您的姓名","reference.passportHint":"請將護照（閉合）對齊綠色框","reference.captureHint":"對齊後按下「擷取」","camera.bright":"亮度足夠","camera.dark":"光線不足","camera.sharp":"畫面清晰","camera.blur":"畫面模糊","camera.capture":"擷取","camera.retake":"重新拍攝","camera.starting":"正在啟動相機…","camera.error":"無法取得相機","camera.retry":"重試","cert.title":"生物測量證書","cert.holder":"持有人","cert.length":"長度","cert.issuedAt":"發證日期","cert.inquiryId":"驗證 ID","cert.footer":"端上測量，身分經 Persona 驗證。","error.issueFailed":"簽發失敗"},ja:{"welcome.title":"生体測定・認証システム","welcome.subtitle":"端末上で測定。画像は端末外に送信されません。本人確認後にデジタル証明書を発行。","welcome.start":"測定を開始","nav.verify":"証明書を検証","nav.myCerts":"マイ証明書","nav.login":"ログイン","nav.logout":"ログアウト","nav.home":"ホーム","step1.title":"ステップ 1 カメラ撮影","step1.hint":"パスポート（閉じた状態）を緑の枠に合わせ、明るさとピントを確認してから撮影してください。","step2.title":"ステップ 2 測定結果","step2.length":"長さ（cm）","step2.live":"ライブ撮影","step2.yes":"はい","step2.no":"いいえ","step2.retake":"再撮影","step2.verify":"本人確認を行う","step2.loading":"読み込み中…","step3.title":"ステップ 3 本人確認 (Persona)","step3.hint":"ポップアップで公的身分証と顔スキャンを完了してください。完了後、証明書のステップに進みます。","step3.openAgain":"もう一度本人確認を開く","step4.title":"ステップ 4 デジタル証明書","step4.inquiryId":"検証 ID","step4.loginRequired":"証明書をダウンロードするにはログインしてください。","step4.goLogin":"ログインへ","step4.certReady":"デジタル証明書（バックエンド署名済み）の準備ができました。","step4.downloadJson":"証明書 JSON をダウンロード","step4.downloadPng":"証明書 PNG をダウンロード","step4.downloadPdf":"証明書 PDF をダウンロード","step4.downloaded":"ダウンロード済み","step4.holderName":"保有者名","step4.holderNamePlaceholder":"お名前を入力","reference.passportHint":"パスポート（閉じた状態）を緑の枠に合わせてください","reference.captureHint":"合わせたら「撮影」を押してください","camera.bright":"十分な明るさ","camera.dark":"暗い","camera.sharp":"くっきり","camera.blur":"ぼやけ","camera.capture":"撮影","camera.retake":"再撮影","camera.starting":"カメラを起動しています…","camera.error":"カメラにアクセスできません","camera.retry":"再試行","cert.title":"生体測定証明書","cert.holder":"保有者","cert.length":"長さ","cert.issuedAt":"発行日","cert.inquiryId":"照会 ID","cert.footer":"端末上で測定。Persona により本人確認済み。","error.issueFailed":"証明書の発行に失敗しました"},es:{"welcome.title":"Medici\xf3n biom\xe9trica y certificaci\xf3n","welcome.subtitle":"Medici\xf3n en dispositivo. Las im\xe1genes no salen del dispositivo. Verificaci\xf3n de identidad para certificado digital.","welcome.start":"Iniciar medici\xf3n","nav.verify":"Verificar certificado","nav.myCerts":"Mis certificados","nav.login":"Iniciar sesi\xf3n","nav.logout":"Cerrar sesi\xf3n","nav.home":"Inicio","step1.title":"Paso 1 Captura de c\xe1mara","step1.hint":"Alinee el pasaporte (cerrado) con el marco verde y asegure buena iluminaci\xf3n, luego capture.","step2.title":"Paso 2 Resultado de medici\xf3n","step2.length":"Longitud (cm)","step2.live":"Captura en vivo","step2.yes":"S\xed","step2.no":"No","step2.retake":"Volver a capturar","step2.verify":"Verificar identidad","step2.loading":"Cargando…","step3.title":"Paso 3 Verificaci\xf3n de identidad (Persona)","step3.hint":"Complete el documento de identidad y el escaneo facial en la ventana emergente. Luego pasar\xe1 al paso del certificado.","step3.openAgain":"Abrir verificaci\xf3n de nuevo","step4.title":"Paso 4 Certificado digital","step4.inquiryId":"ID de verificaci\xf3n","step4.loginRequired":"Inicie sesi\xf3n para descargar el certificado.","step4.goLogin":"Ir a iniciar sesi\xf3n","step4.certReady":"Certificado digital (firmado por el servidor) listo.","step4.downloadJson":"Descargar certificado JSON","step4.downloadPng":"Descargar certificado PNG","step4.downloadPdf":"Descargar certificado PDF","step4.downloaded":"Descargado","step4.holderName":"Nombre del titular","step4.holderNamePlaceholder":"Introduzca su nombre","reference.passportHint":"Alinee el pasaporte (cerrado) con el marco verde","reference.captureHint":"Luego pulse \xabCapturar\xbb","camera.bright":"Suficiente luz","camera.dark":"Poca luz","camera.sharp":"Nitido","camera.blur":"Borrosso","camera.capture":"Capturar","camera.retake":"Volver a capturar","camera.starting":"Iniciando c\xe1mara…","camera.error":"No se puede acceder a la c\xe1mara","camera.retry":"Reintentar","cert.title":"Certificado de medici\xf3n biom\xe9trica","cert.holder":"Titular","cert.length":"Longitud","cert.issuedAt":"Fecha de emisi\xf3n","cert.inquiryId":"ID de consulta","cert.footer":"Medici\xf3n en dispositivo. Identidad verificada por Persona.","error.issueFailed":"Error al emitir el certificado"}}},6881:function(e,t,a){"use strict";a.d(t,{S:function(){return d}});var r,n,i=a(17327),s=a(20357);let l=null!==(r=s.env.NEXT_PUBLIC_SUPABASE_URL)&&void 0!==r?r:"",o=null!==(n=s.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)&&void 0!==n?n:"",c=null;function d(){return c||(c=(0,i.eI)(l||"https://placeholder.supabase.co",o||"placeholder")),c}},48652:function(e,t,a){"use strict";a.d(t,{a:function(){return i}});var r=a(2265),n=a(6881);function i(){var e;let[t,a]=(0,r.useState)(null),[i,s]=(0,r.useState)(!0),l=(0,n.S)();return(0,r.useEffect)(()=>{l.auth.getSession().then(e=>{let{data:{session:t}}=e;a(t),s(!1)});let{data:{subscription:e}}=l.auth.onAuthStateChange((e,t)=>{a(t)});return()=>e.unsubscribe()},[l.auth]),{session:t,loading:i,accessToken:null!==(e=null==t?void 0:t.access_token)&&void 0!==e?e:null}}}},function(e){e.O(0,[505,425,399,663,566,636,938,498,138,149,838,971,23,744],function(){return e(e.s=82788)}),_N_E=e.O()}]);